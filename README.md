
# Java Method Parameter Size Estimation Tool

This project estimates the sizes of parameters passed to Java methods, using information from a `{project}.xml` file generated by [Dependency Finder](http://depfind.sourceforge.net/) and the Java Instrumentation API. The estimated parameter sizes can be used to compute **network overhead** for tools like [`toMicroservice`](10.1109/SANER50967.2021.00042).

---

## üìÅ Project Structure

```
.
‚îú‚îÄ‚îÄ agent/
‚îÇ   ‚îú‚îÄ‚îÄ Agent.java
‚îÇ   ‚îú‚îÄ‚îÄ SizeTester.java
‚îÇ   ‚îú‚îÄ‚îÄ MANIFEST.MF
‚îÇ   ‚îú‚îÄ‚îÄ agent.jar                # Compiled Java agent
‚îú‚îÄ‚îÄ projects/
‚îÇ   ‚îî‚îÄ‚îÄ roller/
‚îÇ       ‚îú‚îÄ‚îÄ roller.xml           # Dependency Finder output
‚îÇ       ‚îú‚îÄ‚îÄ type_list.txt        # Generated list of parameter types
‚îÇ       ‚îú‚îÄ‚îÄ type_size_output.csv # Output from Java agent with sizes
‚îÇ       ‚îú‚îÄ‚îÄ method_parameters_sizeOf.csv # Final mapping of method to param sizes
‚îÇ       ‚îî‚îÄ‚îÄ target/
‚îÇ           ‚îú‚îÄ‚îÄ roller-classes.jar       # Required for loading project-specific classes
            ‚îú‚îÄ‚îÄ roller.war               # Required for extracting dependencies
‚îÇ           ‚îî‚îÄ‚îÄ roller-war-extracted/    # Extracted classes and dependencies from roller.war
‚îú‚îÄ‚îÄ estimate_param_sizes.py      # Python script to run the estimation process
‚îî‚îÄ‚îÄ README.md                    # This file
```

## üõ† Setup Instructions

### 1. Compile the Java Agent

```bash
cd agent
javac Agent.java SizeTester.java
jar cmf MANIFEST.MF agent.jar Agent.class SizeTester.class
```

Make sure your `MANIFEST.MF` contains:

```
Manifest-Version: 1.0
Main-Class: Agent
```

### 2. Prepare Project Classes

1. Place your `roller.xml` (Dependency Finder output) under `projects/roller/`.
2. Extract the `roller.war` file into `projects/roller/target/roller-war-extracted/`. This is necessary to access **third-party dependency classes** used by your application.
3. Add the `roller-classes.jar` to `projects/roller/target/`. This JAR is essential because it contains the **compiled application-specific classes** required to instantiate and estimate parameter sizes correctly.

> ‚ö†Ô∏è Without the extracted WAR and `roller-classes.jar`, the size estimator cannot resolve all classes used in method signatures, leading to fallbacks and reduced accuracy.

### 3. Run the Estimation

```bash
python estimate_param_sizes.py
```

The script will:

1. Parse methods from `roller.xml`
2. Extract parameter types
3. Write unique types to `type_list.txt`
4. Invoke the Java agent to compute size estimates
5. Write final size results to `method_parameters_sizeOf.csv`

## üìÑ Output Format

**method_parameters_sizeOf.csv**

| Method Signature | Parameter Types | Param Sizes | Total Param Size |
|------------------|------------------|--------------|------------------|
| com.foo.Bar(x,y) | int, String      | 4, 64        | 68               |

## ‚úÖ Use Cases

- Estimating data transfer size for inter-method or inter-service communication
- Enhancing microservice decomposition tools by factoring in network overhead
- Static profiling of parameter-heavy methods

## üß† Notes

- Unknown types are assigned a fallback size of 64 bytes.
- Arrays are instantiated with length 1 during size estimation.
- The method works statically ‚Äî no application execution is required.

## üì¨ Contact

If you adapt this tool for runtime use or integrate with additional profilers, feel free to contribute back!
