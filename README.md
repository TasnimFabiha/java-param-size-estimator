# Java Method Parameter Size Estimation Tool

This project estimates the sizes of parameters passed to Java methods, using information from a `{project}.xml` file generated by [Dependency Finder](http://depfind.sourceforge.net/) and the Java Instrumentation API. The estimated parameter sizes can be used to compute **network overhead** for tools like `toMicroservice`.

---

## ğŸ“ Project Structure

```
.
â”œâ”€â”€ agent/
â”‚   â”œâ”€â”€ Agent.java
â”‚   â”œâ”€â”€ SizeTester.java
â”‚   â”œâ”€â”€ manifest.mf
â”‚   â””â”€â”€ agent.jar                # Compiled Java agent
â”œâ”€â”€ projects/
â”‚   â””â”€â”€ roller/
â”‚       â”œâ”€â”€ roller.xml           # deps.xml for your project
â”‚       â”œâ”€â”€ type_list.txt        # Generated list of parameter types
â”‚       â”œâ”€â”€ type_size_output.csv # Output from Java agent with sizes
â”‚       â””â”€â”€ roller_method_size.csv # Final method + size mapping
â”œâ”€â”€ estimate_param_sizes.py      # Main Python script
â””â”€â”€ README.md                    # This file
```

---

## ğŸ›  Setup

### 1. Compile the Java Agent

```bash
cd agent
javac Agent.java SizeTester.java
jar cmf manifest.mf agent.jar Agent.class SizeTester.class
```

Make sure the manifest file contains:

```text
Manifest-Version: 1.0
Main-Class: Agent

```

---

### 2. Prepare Input

- Place your Dependency Finder output XML as: `projects/<project_name>/<project_name>.xml`
- Update the `project_name` variable in `estimate_param_sizes.py` accordingly.

---

## ğŸš€ Run

```bash
python estimate_param_sizes.py
```

This script will:

1. Parse all methods from `<project>.xml`
2. Extract parameter types
3. Write a unique list of types to `type_list.txt`
4. Call the Java agent to measure sizes
5. Save final method-size mapping in `method_parameters_sizeOf.csv`

---

## ğŸ“„ Output

### Final Output: `<project>_method_size.csv`

| Method Signature | Parameter Types | Param Sizes | Total Param Size |
|------------------|-----------------|-------------|------------------|
| com.foo.Bar(x,y) | int, String     | 4, 64       | 68               |

---

## ğŸ§  Notes

- If a parameter type is unknown or cannot be instantiated, a default fallback size of `64` bytes is used.
- Size estimation is **heuristic-based** and may not reflect exact JVM memory layout.
- The approach works without running the full application â€” only the type names are needed.

---

## âœ… Use Cases

- Estimating data transfer size for inter-method or inter-service communication
- Enhancing microservice decomposition tools by including network overhead factors
- Static profiling of parameter-heavy methods

---

## ğŸ“¬ Contact

If you extend this tool or adapt it to support runtime instrumentation or live profiling, contributions are welcome!

---
