
# Java Method Parameter Size Estimation Tool

This project estimates the sizes of parameters passed to Java methods using method signature information from:

- A `{project}.xml` file generated by [Dependency Finder](http://depfind.sourceforge.net/), and  
- A `fully-qualified-methods.txt` file generated by the [java-method-scanner](https://github.com/TasnimFabiha/java-method-scanner), which extracts all project-defined methods using ClassGraph, ensuring better coverage.

The size estimation is performed using the Java Instrumentation API, and the results can be used to compute **network overhead**, particularly for tools like [`toMicroservice`](https://doi.org/10.1109/SANER50967.2021.00042).

---

## ğŸ“ Project Structure

```
.
â”œâ”€â”€ agent/
â”‚   â”œâ”€â”€ Agent.java
â”‚   â”œâ”€â”€ SizeTester.java
â”‚   â”œâ”€â”€ MANIFEST.MF
â”‚   â”œâ”€â”€ agent.jar                # Compiled Java agent
â”œâ”€â”€ projects/
â”‚   â””â”€â”€ roller/
â”‚       â”œâ”€â”€ roller.xml           # Dependency Finder output
â”‚       â”œâ”€â”€ fully-qualified-methods.txt        # List of project-defined method signatures
â”‚       â”œâ”€â”€ type_list.txt        # Generated list of parameter types
â”‚       â”œâ”€â”€ type_size_output.csv # Output from Java agent with sizes
â”‚       â”œâ”€â”€ method_parameters_sizeOf.csv # Final mapping of method to param sizes
â”‚       â”œâ”€â”€ pom.xml # Required to include runtime maven dependencies
â”‚       â””â”€â”€ target/
â”‚           â”œâ”€â”€ classes/                 # Required for loading project-specific classes
â”‚           â”œâ”€â”€ dependency/              # Required for saving mvn runtime dependency
â”‚           â”œâ”€â”€ roller.war               # Required for extracting dependencies
â”‚           â””â”€â”€ roller-war-extracted/    # Extracted classes and dependencies from roller.war
â”œâ”€â”€ estimate_param_sizes.py      # Python script to run the estimation process
â””â”€â”€ README.md                    # This file
```

## ğŸ›  Setup Instructions

### 1. Compile the Java Agent

```bash
cd agent
javac Agent.java SizeTester.java
jar cmf MANIFEST.MF agent.jar Agent.class SizeTester.class
```

Make sure your `MANIFEST.MF` contains:

```
Manifest-Version: 1.0
Main-Class: Agent
```

### 2. Prepare Input

Either one or both of the following inputs are needed:

- `<project_name>.xml`: generated by Dependency Finder (may skip some classes for missing run-time dependencies)
- `fully-qualified-methods.txt`: generated by [`java-method-scanner`](https://github.com/TasnimFabiha/java-method-scanner), which ensures complete coverage of all project-defined methods (those written in the codebase) and their parameters.

If estimating the size of project-specific methods is the main goal, then `fully-qualified-methods.txt`t alone is sufficient, and the Dependency Finder input can be safely omitted.


1. Place `fully-qualified-methods.txt` (required) in `projects/<project_name>/`.
2. Place the Dependency Finder output XML as: `projects/<project_name>/<project_name>.xml`
3. Update the `project_name` variable in `estimate_param_sizes.py` accordingly.
4. Extract the `<project_name>.war` file into `projects/<project_name>/target/<project_name>-war-extracted/`. This is necessary to access **third-party dependency classes** used by your application.
5. Add the compiled `classes` to `projects/<project_name>/target/classes`. This is essential because it contains the **compiled application-specific classes** required to instantiate and estimate parameter sizes correctly.
6. Add the `pom.xml` to `projects/<project_name>` This will help include all run time dependency (dependencies that are not compiled or packaged with the project) in the `projects/<project_name>/target/dependency` folder.

> âš ï¸ Without the extracted WAR, or the `<project_name>/target/classes` or the `pom.xml`, the size estimator cannot resolve all classes used in method signatures, leading to fallbacks and reduced accuracy.

### 3. Run the Estimation

```bash
python estimate_param_sizes.py
```

The script will:

1. Parse methods from `fully-qualified-methods.txt` and `<project_name>.xml`
2. Extract parameter types
3. Write unique types to `type_list.txt`
4. Invoke the Java agent to compute size estimates
5. Write final size results to `method_parameters_sizeOf.csv`

## ğŸ“„ Output Format

**method_parameters_sizeOf.csv**

| Method Signature | Parameter Types | Param Sizes | Total Param Size |
|------------------|------------------|--------------|------------------|
| com.foo.Bar(x,y) | int, String      | 4, 64        | 68               |

## âœ… Use Cases

- Estimating data transfer size for inter-method or inter-service communication
- Enhancing microservice decomposition tools by factoring in network overhead
- Static profiling of parameter-heavy methods

## ğŸ§  Notes

- Unknown types are assigned a fallback size of -1 bytes.
- Arrays are instantiated with length 1 during size estimation.
- The method works statically â€” no application execution is required.

