
# Java Method Parameter Size Estimation Tool

This project estimates the sizes of parameters passed to Java methods, using information from a `{project}.xml` file generated by [Dependency Finder](http://depfind.sourceforge.net/) and the Java Instrumentation API. The estimated parameter sizes can be used to compute **network overhead** for tools like [`toMicroservice`](10.1109/SANER50967.2021.00042).

---

## 📁 Project Structure

```
.
├── agent/
│   ├── Agent.java
│   ├── SizeTester.java
│   ├── MANIFEST.MF
│   ├── agent.jar                # Compiled Java agent
├── projects/
│   └── roller/
│       ├── roller.xml           # Dependency Finder output
│       ├── type_list.txt        # Generated list of parameter types
│       ├── type_size_output.csv # Output from Java agent with sizes
│       ├── method_parameters_sizeOf.csv # Final mapping of method to param sizes
│       └── target/
│           ├── roller-classes.jar       # Required for loading project-specific classes
            ├── roller.war               # Required for extracting dependencies
│           └── roller-war-extracted/    # Extracted classes and dependencies from roller.war
├── estimate_param_sizes.py      # Python script to run the estimation process
└── README.md                    # This file
```

## 🛠 Setup Instructions

### 1. Compile the Java Agent

```bash
cd agent
javac Agent.java SizeTester.java
jar cmf MANIFEST.MF agent.jar Agent.class SizeTester.class
```

Make sure your `MANIFEST.MF` contains:

```
Manifest-Version: 1.0
Main-Class: Agent
```

### 2. Prepare Input

1. Place your Dependency Finder output XML as: `projects/<project_name>/<project_name>.xml`
2. Here, the example project `roller` has been used for example. Update the `project_name` variable in `estimate_param_sizes.py` accordingly.
3. Extract the `<project_name>.war` file into `projects/<project_name>/target/<project_name>-war-extracted/`. This is necessary to access **third-party dependency classes** used by your application.
4. Add the `<project_name>-classes.jar` to `projects/<project_name>/target/` if present. This JAR is essential because it contains the **compiled application-specific classes** required to instantiate and estimate parameter sizes correctly.

> ⚠️ Without the extracted WAR and `<project_name>-classes.jar`, the size estimator cannot resolve all classes used in method signatures, leading to fallbacks and reduced accuracy.

### 3. Run the Estimation

```bash
python estimate_param_sizes.py
```

The script will:

1. Parse methods from `<project_name>.xml`
2. Extract parameter types
3. Write unique types to `type_list.txt`
4. Invoke the Java agent to compute size estimates
5. Write final size results to `method_parameters_sizeOf.csv`

## 📄 Output Format

**method_parameters_sizeOf.csv**

| Method Signature | Parameter Types | Param Sizes | Total Param Size |
|------------------|------------------|--------------|------------------|
| com.foo.Bar(x,y) | int, String      | 4, 64        | 68               |

## ✅ Use Cases

- Estimating data transfer size for inter-method or inter-service communication
- Enhancing microservice decomposition tools by factoring in network overhead
- Static profiling of parameter-heavy methods

## 🧠 Notes

- Unknown types are assigned a fallback size of 64 bytes.
- Arrays are instantiated with length 1 during size estimation.
- The method works statically — no application execution is required.

## 📬 Contact

If you adapt this tool for runtime use or integrate with additional profilers, feel free to contribute back!
